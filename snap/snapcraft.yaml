name: huggle
version: "3.4.0"
summary: Diff browser for MediaWiki based websites intended to deal with vandalism
description: Diff browser for MediaWiki based websites intended to deal with vandalism
confinement: strict
epoch: 0
grade: stable

apps:
  huggle:
    command: desktop-launch huggle
    plugs:
        - unity7
        - x11
        - network
        - home
        - opengl
        - pulseaudio
        - browser-support

parts:
  application:
    prepare: ./build/prepare_snap.sh
    plugin: cmake
    configflags:
      - -DQT5_BUILD=true
      - -DLINUX_SNAP=true
      - -DHUGGLE_EXT=true
      - -DWEB_ENGINE=true
    source: src/
    stage-packages:
      - libxkbcommon0
      - ttf-ubuntu-font-family
      - dmz-cursor-theme
      - light-themes
      - locales-all
      - shared-mime-info
      - libqt5gui5
      - libqt5core5a
      - libqt5webengine5
      - libqt5concurrent5
      - libqt5quickparticles5
      - libqt5widgets5
      - libqt5quickwidgets5
      - libqt5network5
      - libqt5multimediaquick-p5
      - libqt5multimediawidgets5
      - libqt5xml5
      - libc6
    build-packages:
      - libgtk2.0-0
      - libdrm-dev
      - libegl1-mesa-dev
      - qtbase5-dev
      - libgl1-mesa-dev
      - libglu1-mesa-dev
      - libqt5opengl5-dev
      - libwayland-dev
      - libx11-dev
      - qtmultimedia5-dev
      - qtwebengine5-dev
    after: [desktop-qt5]

  desktop-qt5: #custom define, see BUG: https://github.com/ubuntu/snapcraft-desktop-helpers/issues/62
    stage-packages:
      - libxkbcommon0
      - ttf-ubuntu-font-family
      - dmz-cursor-theme
      - light-themes
      - shared-mime-info
      - libqt5gui5
      - libgdk-pixbuf2.0-0
      - libqt5svg5 # for loading icon themes which are svg
      - locales-all
      - libc6
